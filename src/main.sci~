// =========================================================================
// Point d'entree 
// =========================================================================
clear; clc; close;

disp('=========================================');
disp('  Plateforme Traitement Signal   ');
disp('=========================================');
disp('');

// Déterminer le chemin du dossier source
current_path = pwd();

// Vérifier si on est dans src
if ~isdir('config') then
    // On n'est pas dans src, essayer d'y aller
    if isdir('src') then
        cd('src');
        disp('Navigation vers src/');
    else
        error('Erreur : Impossible de trouver le dossier src. Lancez depuis le dossier Plateforme_Traitement_Signal ou src/');
    end
end
source_path = pwd();
disp('Chemin src : ' + source_path);
disp('');

disp('Chargement des modules de base...');

// 1. Configuration
disp('  -> config/config.sci');
exec('config\config.sci', -1);

// 2. Utilitaires
disp('  -> utils/math_utils.sci');
exec('utils\math_utils.sci', -1);
disp('  -> utils/signal_utils.sci');
exec('utils\signal_utils.sci', -1);

// 3. Interface utilisateur
disp('  -> interface/interface.sci');
exec('interface\interface.sci', -1);
disp('  -> interface/events.sci');
exec('interface\events.sci', -1);
disp('  -> interface/display.sci');
exec('interface\display.sci', -1);

// 4. Modules de traitement (chargement dynamique)
disp('Chargement des modules de traitement dynamiques (dossier modules/)...');
module_directory = 'modules\';

// CORRECTION: listfiles() retourne déjà le chemin complet
module_files = listfiles(module_directory + 'process_*.sci');

if isempty(module_files) then
    disp('ATTENTION : Aucun module de traitement trouvé dans ' + module_directory);
else
    for i = 1:size(module_files, 1)
        full_path = module_files(i);  // listfiles retourne déjà le chemin complet
        disp('  -> ' + full_path);
        exec(full_path, -1);
    end
end

disp('');
disp('Tous les modules chargés !');
disp('');

disp('Lancement de l''interface...');
create_main_interface();
disp('Application prete !');
disp('Selectionnez un theme et cliquez sur GENERER.');
disp('');
